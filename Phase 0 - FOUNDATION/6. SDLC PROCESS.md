# SDLC PROCESS - Kaven Boilerplate

> **Version:** 1.0.0  
> **Date:** December 16, 2025  
> **Author:** Chris (@bychrisr)  
> **Type:** Software Development Life Cycle Process  
> **Status:** Foundation Phase

---

## ğŸ“‹ TABLE OF CONTENTS

1. [SDLC Overview](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#sdlc-overview)
2. [Development Methodology](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#development-methodology)
3. [Git Workflow](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#git-workflow)
4. [Branching Strategy](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#branching-strategy)
5. [Commit Convention](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#commit-convention)
6. [Code Review Process](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#code-review-process)
7. [Testing Strategy](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#testing-strategy)
8. [CI/CD Pipeline](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#cicd-pipeline)
9. [Documentation Requirements](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#documentation-requirements)
10. [Quality Gates](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#quality-gates)
11. [Release Process](https://claude.ai/chat/85762b85-c660-45f4-b12b-87d80239cb61#release-process)

---

## ğŸ¯ SDLC OVERVIEW

### Philosophy

> "Ship fast, ship safe, ship often. Quality is not negotiable."

**Core Principles:**

1. **Documentation First:** Write specs before code
2. **Test-Driven Development:** Write tests before implementation
3. **Continuous Integration:** Merge often, test automatically
4. **Code Review:** Every PR reviewed before merge
5. **Iterative Delivery:** Small, frequent releases

---

### Methodology: Hybrid Approach

Kaven uses a **hybrid methodology** combining best practices from:

1. **Iterative Development** (Agile-inspired)
    
    - Work in short cycles (1-2 weeks)
    - Deliver working features incrementally
    - Adapt based on feedback
2. **V-Model** (Testing focus)
    
    - Every development phase has corresponding test phase
    - Test each module before moving to next
    - Verification and validation at every step
3. **DevSecOps** (Security + Automation)
    
    - Security built-in from day 1
    - Automated testing and deployment
    - Continuous monitoring

---

### Development Cycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   KAVEN DEVELOPMENT CYCLE                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Week 1-2: DOCUMENTATION PHASE
â”œâ”€ Write specifications
â”œâ”€ Define acceptance criteria
â”œâ”€ Create API contracts
â””â”€ Review with stakeholders

Week 3-4: DEVELOPMENT PHASE (Module 1)
â”œâ”€ Write unit tests (TDD)
â”œâ”€ Implement feature
â”œâ”€ Write integration tests
â”œâ”€ Code review
â””â”€ Merge to main

Week 5-6: DEVELOPMENT PHASE (Module 2)
â”œâ”€ Repeat cycle
â””â”€ Build on top of Module 1

Week 7-8: INTEGRATION & POLISH
â”œâ”€ E2E testing
â”œâ”€ Performance optimization
â”œâ”€ Security audit
â””â”€ Documentation update

Week 9: RELEASE
â”œâ”€ Final testing
â”œâ”€ Deploy to staging
â”œâ”€ Deploy to production
â””â”€ Monitor & iterate
```

---

## ğŸ”„ DEVELOPMENT METHODOLOGY

### Iterative + V-Model Hybrid

**Phase 1: Requirements (Documentation)**

```
Document â†’ Review â†’ Approve
```

- Write detailed specifications
- Define acceptance criteria
- Get stakeholder approval
- **Output:** Approved specs (SCOPE_COMPLETE.md, API_SPECIFICATION.md, etc.)

**Phase 2: Design (Architecture)**

```
Design â†’ Review â†’ Validate
```

- Create architecture diagrams
- Define database schema
- Design API contracts
- **Output:** Architecture documents (ARCHITECTURE.md, DATABASE_SPECIFICATION.md)

**Phase 3: Implementation (Code)**

```
Write Tests â†’ Write Code â†’ Code Review â†’ Merge
```

- Write unit tests first (TDD)
- Implement feature
- Write integration tests
- Peer code review
- **Output:** Working, tested code

**Phase 4: Verification (Testing)**

```
Unit Tests â†’ Integration Tests â†’ E2E Tests â†’ Performance Tests
```

- Verify each layer independently
- Test integration between modules
- Test complete user flows
- **Output:** Test reports, coverage metrics

**Phase 5: Deployment (Release)**

```
Build â†’ Test â†’ Deploy Staging â†’ Test â†’ Deploy Production
```

- Automated builds via CI/CD
- Deploy to staging first
- Smoke tests in staging
- Deploy to production
- **Output:** Live feature in production

**Phase 6: Maintenance (Monitor)**

```
Monitor â†’ Analyze â†’ Fix â†’ Improve
```

- Monitor metrics (Prometheus, Grafana)
- Analyze user feedback
- Fix bugs quickly
- Iterate based on data
- **Output:** Bug fixes, improvements

---

### Test-Driven Development (TDD)

**TDD Cycle (Red-Green-Refactor):**

```
1. RED: Write failing test
   â†“
2. GREEN: Write minimal code to pass test
   â†“
3. REFACTOR: Improve code quality
   â†“
4. REPEAT
```

**Example:**

```typescript
// 1. RED: Write failing test
describe('UserService', () => {
  it('should create user with valid email', async () => {
    const user = await userService.create({
      email: 'test@example.com',
      name: 'Test User',
      password: 'Password123!'
    });
    
    expect(user.email).toBe('test@example.com');
    expect(user.emailVerified).toBe(false);
  });
});

// Test fails (UserService.create not implemented yet)

// 2. GREEN: Write minimal code
class UserService {
  async create(data: CreateUserInput) {
    const user = await prisma.user.create({
      data: {
        email: data.email,
        name: data.name,
        passwordHash: await bcrypt.hash(data.password, 12),
        emailVerified: false
      }
    });
    return user;
  }
}

// Test passes!

// 3. REFACTOR: Improve code
class UserService {
  async create(data: CreateUserInput) {
    // Validate input
    const validated = createUserSchema.parse(data);
    
    // Hash password
    const passwordHash = await this.hashPassword(validated.password);
    
    // Create user
    const user = await prisma.user.create({
      data: {
        email: validated.email,
        name: validated.name,
        passwordHash,
        emailVerified: false
      }
    });
    
    // Send verification email (async)
    await this.sendVerificationEmail(user);
    
    return user;
  }
  
  private async hashPassword(password: string): Promise<string> {
    return bcrypt.hash(password, 12);
  }
  
  private async sendVerificationEmail(user: User): Promise<void> {
    // Implementation
  }
}

// Test still passes, code is cleaner
```

**Benefits:**

- âœ… Better design (tests force good architecture)
- âœ… Higher confidence (code proven to work)
- âœ… Faster debugging (tests catch issues early)
- âœ… Living documentation (tests show how to use code)

---

## ğŸŒ¿ GIT WORKFLOW

### Branch Strategy: GitHub Flow (Simplified)

**Main Branches:**

- `main` - Production-ready code (always deployable)
- `develop` - Integration branch (optional for larger teams)

**Supporting Branches:**

- `feature/*` - New features
- `fix/*` - Bug fixes
- `hotfix/*` - Urgent production fixes
- `docs/*` - Documentation updates
- `refactor/*` - Code refactoring
- `test/*` - Test additions/improvements

---

### Workflow Steps

**1. Create Feature Branch**

```bash
# From main
git checkout main
git pull origin main

# Create feature branch
git checkout -b feature/auth-2fa

# Naming convention: <type>/<description>
# Types: feature, fix, hotfix, docs, refactor, test
```

**2. Develop**

```bash
# Make changes
# Write tests
# Commit often (small, atomic commits)

git add .
git commit -m "feat(auth): add 2FA TOTP setup endpoint"
```

**3. Push & Create PR**

```bash
# Push to remote
git push origin feature/auth-2fa

# Create Pull Request on GitHub
# Title: "feat(auth): Add 2FA TOTP authentication"
# Description: Explain what, why, how
```

**4. Code Review**

```bash
# Reviewer reviews code
# Developer addresses feedback
# Iterate until approved
```

**5. Merge**

```bash
# Squash and merge (recommended for clean history)
# OR merge commit (preserves branch history)

# After merge, delete branch
git branch -d feature/auth-2fa
git push origin --delete feature/auth-2fa
```

**6. Deploy**

```bash
# CI/CD automatically deploys from main
# Monitor deployment
# Verify in production
```

---

## ğŸŒ³ BRANCHING STRATEGY

### Branch Naming Convention

**Format:** `<type>/<ticket-number>-<short-description>`

**Types:**

- `feature/` - New features
- `fix/` - Bug fixes
- `hotfix/` - Urgent production fixes
- `docs/` - Documentation
- `refactor/` - Code improvements
- `test/` - Test additions
- `chore/` - Maintenance tasks

**Examples:**

```bash
feature/KAVEN-123-add-2fa-authentication
fix/KAVEN-456-fix-login-rate-limit
hotfix/KAVEN-789-patch-security-vulnerability
docs/KAVEN-101-update-api-documentation
refactor/KAVEN-202-improve-tenant-middleware
test/KAVEN-303-add-e2e-tests-for-auth
chore/KAVEN-404-update-dependencies
```

**Without Ticket Numbers (Solo Development):**

```bash
feature/auth-2fa
fix/login-rate-limit
hotfix/security-patch
docs/api-documentation
refactor/tenant-middleware
test/auth-e2e
chore/update-deps
```

---

### Branch Protection Rules

**For `main` branch:**

1. **Require pull request reviews**
    
    - At least 1 approval required
    - Dismiss stale reviews on new commits
    - Require review from code owners (optional)
2. **Require status checks to pass**
    
    - âœ… Linting (ESLint)
    - âœ… Type checking (TypeScript)
    - âœ… Unit tests
    - âœ… Integration tests
    - âœ… Build succeeds
3. **Require branches to be up to date**
    
    - Force rebase/merge before merging
4. **No direct commits to main**
    
    - All changes via pull requests
5. **Require signed commits (optional)**
    
    - GPG signature verification

---

## ğŸ“ COMMIT CONVENTION

### Conventional Commits Specification

**Format:**

```
<type>(<scope>): <subject>

<body>

<footer>
```

**Types:**

- `feat` - New feature
- `fix` - Bug fix
- `docs` - Documentation changes
- `style` - Code style (formatting, no logic change)
- `refactor` - Code refactoring
- `perf` - Performance improvement
- `test` - Test additions/changes
- `chore` - Maintenance (deps, config, etc)
- `ci` - CI/CD changes
- `build` - Build system changes

**Scopes (Optional):**

- `auth` - Authentication module
- `tenant` - Multi-tenant module
- `rbac` - RBAC module
- `payments` - Payment module
- `ui` - Frontend components
- `api` - Backend API
- `db` - Database changes
- `docs` - Documentation

**Examples:**

```bash
# Feature
feat(auth): add 2FA TOTP authentication

Implements TOTP-based 2FA using speakeasy library.
Includes QR code generation and backup codes.

Closes #123

# Bug fix
fix(payments): resolve Stripe webhook signature validation

Fixed webhook signature verification that was failing
for certain payload sizes.

Fixes #456

# Documentation
docs(api): add authentication endpoints documentation

Added comprehensive documentation for all auth endpoints
including request/response examples.

# Refactor
refactor(tenant): improve middleware performance

Optimized tenant lookup by adding Redis caching.
Reduced average response time by 50ms.

# Breaking change
feat(api)!: change user endpoint response structure

BREAKING CHANGE: User endpoint now returns nested tenant object
instead of flat tenantId field.

Migration guide: https://docs.kaven.io/migration/v2

# Multiple changes
feat(auth): add 2FA support

- Implement TOTP authentication
- Add QR code generation
- Create backup codes system
- Add 2FA settings page

Closes #123, #124, #125
```

---

### Commit Message Best Practices

**DO:**

- âœ… Use imperative mood ("add" not "added")
- âœ… Keep subject under 72 characters
- âœ… Capitalize subject line
- âœ… No period at end of subject
- âœ… Separate subject from body with blank line
- âœ… Explain what and why, not how
- âœ… Reference issues/tickets

**DON'T:**

- âŒ `git commit -m "fix"` (too vague)
- âŒ `git commit -m "WIP"` (work in progress commits should be squashed)
- âŒ `git commit -m "Fixed the thing that was broken"` (not descriptive)
- âŒ Commit commented-out code (delete it)
- âŒ Commit merge conflicts (resolve first)

---

## ğŸ‘€ CODE REVIEW PROCESS

### Pull Request Guidelines

**PR Title:** Follow commit convention: `<type>(<scope>): <description>`

**PR Description Template:**

```markdown
## Description
Brief description of what this PR does.

## Changes
- Change 1
- Change 2
- Change 3

## Type of Change
- [ ] Bug fix
- [ ] New feature
- [ ] Breaking change
- [ ] Documentation update

## Testing
- [ ] Unit tests added/updated
- [ ] Integration tests added/updated
- [ ] E2E tests added/updated
- [ ] Manual testing completed

## Screenshots (if applicable)
![Screenshot](url)

## Checklist
- [ ] Code follows style guidelines
- [ ] Self-review completed
- [ ] Comments added for complex logic
- [ ] Documentation updated
- [ ] No new warnings generated
- [ ] Tests pass locally
- [ ] Dependent changes merged

## Related Issues
Closes #123
Relates to #456
```

---

### Review Process

**1. Self-Review (Author)**

```
Before requesting review:
â”œâ”€ Run linter (ESLint)
â”œâ”€ Run type check (TypeScript)
â”œâ”€ Run tests locally
â”œâ”€ Test manually
â”œâ”€ Review own code (GitHub diff)
â””â”€ Write clear PR description
```

**2. Automated Checks**

```
CI/CD runs automatically:
â”œâ”€ Linting
â”œâ”€ Type checking
â”œâ”€ Unit tests
â”œâ”€ Integration tests
â”œâ”€ Build verification
â””â”€ Coverage report
```

**3. Peer Review (Reviewer)**

```
Review checklist:
â”œâ”€ Code quality
â”‚  â”œâ”€ Readable and maintainable
â”‚  â”œâ”€ Follows project conventions
â”‚  â”œâ”€ No code smells
â”‚  â””â”€ Proper error handling
â”‚
â”œâ”€ Logic correctness
â”‚  â”œâ”€ Solves stated problem
â”‚  â”œâ”€ Edge cases handled
â”‚  â”œâ”€ No obvious bugs
â”‚  â””â”€ Security considerations
â”‚
â”œâ”€ Tests
â”‚  â”œâ”€ Adequate test coverage
â”‚  â”œâ”€ Tests are meaningful
â”‚  â””â”€ Tests pass
â”‚
â””â”€ Documentation
   â”œâ”€ Comments for complex logic
   â”œâ”€ API docs updated
   â””â”€ README updated if needed
```

**4. Feedback & Iteration**

```
Reviewer leaves comments:
â”œâ”€ Request changes (blocking)
â”œâ”€ Suggestions (non-blocking)
â””â”€ Approve (ready to merge)

Author addresses feedback:
â”œâ”€ Make changes
â”œâ”€ Respond to comments
â”œâ”€ Push new commits
â””â”€ Request re-review
```

**5. Approval & Merge**

```
After approval:
â”œâ”€ Squash and merge (recommended)
â”œâ”€ Delete source branch
â””â”€ CI/CD deploys automatically
```

---

### Code Review Best Practices

**For Reviewers:**

- âœ… Be kind and constructive
- âœ… Ask questions, don't demand
- âœ… Praise good code
- âœ… Provide context for suggestions
- âœ… Distinguish between blocking and non-blocking feedback
- âœ… Review within 24 hours
- âŒ Nitpick unnecessarily
- âŒ Be condescending
- âŒ Approve without actually reviewing

**For Authors:**

- âœ… Keep PRs small (< 400 lines)
- âœ… Write clear descriptions
- âœ… Respond to all comments
- âœ… Don't take feedback personally
- âœ… Ask for clarification if needed
- âŒ Get defensive
- âŒ Ignore feedback
- âŒ Force merge without approval

---

## ğŸ§ª TESTING STRATEGY

### Test Pyramid

```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   E2E Tests   â”‚  10%  (Slow, expensive)
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Integration Tests   â”‚  30%  (Medium speed)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚      Unit Tests           â”‚  60%  (Fast, cheap)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Philosophy:**

- More unit tests (fast, isolated)
- Some integration tests (component interaction)
- Few E2E tests (critical user flows)

---

### Unit Tests

**What to Test:**

- Individual functions
- Service methods
- Utility functions
- Business logic
- Edge cases

**Framework:** Vitest

**Example:**

```typescript
// auth.service.test.ts
import { describe, it, expect, beforeEach } from 'vitest';
import { AuthService } from './auth.service';

describe('AuthService', () => {
  let authService: AuthService;
  
  beforeEach(() => {
    authService = new AuthService();
  });
  
  describe('hashPassword', () => {
    it('should hash password with bcrypt', async () => {
      const password = 'Password123!';
      const hash = await authService.hashPassword(password);
      
      expect(hash).toBeDefined();
      expect(hash).not.toBe(password);
      expect(hash.length).toBeGreaterThan(50);
    });
    
    it('should generate different hashes for same password', async () => {
      const password = 'Password123!';
      const hash1 = await authService.hashPassword(password);
      const hash2 = await authService.hashPassword(password);
      
      expect(hash1).not.toBe(hash2); // Salted
    });
  });
  
  describe('verifyPassword', () => {
    it('should return true for correct password', async () => {
      const password = 'Password123!';
      const hash = await authService.hashPassword(password);
      const isValid = await authService.verifyPassword(password, hash);
      
      expect(isValid).toBe(true);
    });
    
    it('should return false for incorrect password', async () => {
      const password = 'Password123!';
      const hash = await authService.hashPassword(password);
      const isValid = await authService.verifyPassword('WrongPassword', hash);
      
      expect(isValid).toBe(false);
    });
  });
});
```

**Coverage Target:** 80%+

---

### Integration Tests

**What to Test:**

- API endpoints
- Database operations
- External service integration
- Module interaction

**Framework:** Vitest + Supertest

**Example:**

```typescript
// auth.integration.test.ts
import { describe, it, expect, beforeAll, afterAll } from 'vitest';
import request from 'supertest';
import { app } from '../app';
import { prisma } from '../lib/prisma';

describe('POST /api/auth/register', () => {
  beforeAll(async () => {
    // Setup test database
    await prisma.$connect();
  });
  
  afterAll(async () => {
    // Cleanup
    await prisma.user.deleteMany();
    await prisma.$disconnect();
  });
  
  it('should register new user with valid data', async () => {
    const response = await request(app)
      .post('/api/auth/register')
      .send({
        email: 'test@example.com',
        name: 'Test User',
        password: 'Password123!'
      });
    
    expect(response.status).toBe(201);
    expect(response.body).toHaveProperty('id');
    expect(response.body.email).toBe('test@example.com');
    expect(response.body.emailVerified).toBe(false);
  });
  
  it('should reject duplicate email', async () => {
    // Create first user
    await request(app)
      .post('/api/auth/register')
      .send({
        email: 'duplicate@example.com',
        name: 'User 1',
        password: 'Password123!'
      });
    
    // Try to create duplicate
    const response = await request(app)
      .post('/api/auth/register')
      .send({
        email: 'duplicate@example.com',
        name: 'User 2',
        password: 'Password123!'
      });
    
    expect(response.status).toBe(409);
    expect(response.body.error).toBe('Email already exists');
  });
  
  it('should reject weak password', async () => {
    const response = await request(app)
      .post('/api/auth/register')
      .send({
        email: 'weak@example.com',
        name: 'Weak User',
        password: '123' // Too short
      });
    
    expect(response.status).toBe(400);
    expect(response.body.errors).toContainEqual({
      path: ['password'],
      message: 'Password must be at least 8 characters'
    });
  });
});
```

---

### E2E Tests

**What to Test:**

- Complete user flows
- Critical business processes
- Cross-browser compatibility
- Mobile responsiveness

**Framework:** Playwright

**Example:**

```typescript
// auth.e2e.test.ts
import { test, expect } from '@playwright/test';

test.describe('Authentication Flow', () => {
  test('should complete full registration and login flow', async ({ page }) => {
    // 1. Visit registration page
    await page.goto('http://localhost:3000/register');
    
    // 2. Fill registration form
    await page.fill('input[name="email"]', 'e2e@example.com');
    await page.fill('input[name="name"]', 'E2E Test User');
    await page.fill('input[name="password"]', 'Password123!');
    
    // 3. Submit form
    await page.click('button[type="submit"]');
    
    // 4. Verify success message
    await expect(page.locator('text=Check your email')).toBeVisible();
    
    // 5. Simulate email verification (direct DB update in test)
    // In real scenario, would click email link
    
    // 6. Login
    await page.goto('http://localhost:3000/login');
    await page.fill('input[name="email"]', 'e2e@example.com');
    await page.fill('input[name="password"]', 'Password123!');
    await page.click('button[type="submit"]');
    
    // 7. Verify dashboard redirect
    await expect(page).toHaveURL('http://localhost:3000/dashboard');
    await expect(page.locator('h1')).toContainText('Dashboard');
  });
  
  test('should show validation errors for invalid data', async ({ page }) => {
    await page.goto('http://localhost:3000/register');
    
    // Try to submit empty form
    await page.click('button[type="submit"]');
    
    // Verify error messages
    await expect(page.locator('text=Email is required')).toBeVisible();
    await expect(page.locator('text=Name is required')).toBeVisible();
    await expect(page.locator('text=Password is required')).toBeVisible();
  });
});
```

**Coverage Target:** Critical flows only (login, registration, checkout, etc.)

---

### Performance Tests

**What to Test:**

- API response times
- Database query performance
- Page load times
- Concurrent user handling

**Framework:** k6 (load testing)

**Example:**

```javascript
// load-test.js
import http from 'k6/http';
import { check, sleep } from 'k6';

export const options = {
  stages: [
    { duration: '30s', target: 20 },  // Ramp up to 20 users
    { duration: '1m', target: 50 },   // Ramp up to 50 users
    { duration: '30s', target: 0 },   // Ramp down
  ],
  thresholds: {
    http_req_duration: ['p(95)<500'], // 95% of requests < 500ms
    http_req_failed: ['rate<0.01'],   // Error rate < 1%
  },
};

export default function () {
  // Test login endpoint
  const loginRes = http.post('http://localhost:8000/api/auth/login', {
    email: 'test@example.com',
    password: 'Password123!',
  });
  
  check(loginRes, {
    'status is 200': (r) => r.status === 200,
    'response time < 500ms': (r) => r.timings.duration < 500,
    'has access token': (r) => r.json('accessToken') !== undefined,
  });
  
  sleep(1);
}
```

---

### Test Coverage

**Minimum Coverage Targets:**

- Unit tests: 80%+
- Integration tests: 60%+
- E2E tests: Critical flows (not measured by coverage)

**Measure Coverage:**

```bash
# Run tests with coverage
pnpm run test:coverage

# View coverage report
open coverage/index.html
```

**Coverage Report Example:**

```
File                | % Stmts | % Branch | % Funcs | % Lines
--------------------|---------|----------|---------|--------
All files           |   85.2  |   78.3   |   82.1  |   85.5
 auth/              |   92.1  |   88.4   |   90.2  |   92.3
  auth.service.ts   |   95.5  |   91.2   |   94.1  |   95.7
  auth.controller.ts|   88.3  |   84.6   |   85.9  |   88.5
 tenant/            |   78.4  |   70.2   |   75.8  |   78.9
```

**Action if below target:**

- Write more tests
- Remove dead code
- Simplify overly complex logic

---

## ğŸš€ CI/CD PIPELINE

### GitHub Actions Workflow

**File:** `.github/workflows/ci.yml`

```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  # Job 1: Lint & Type Check
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      
      - uses: actions/setup-node@v3
        with:
          node-version: 20
          cache: 'pnpm'
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Lint
        run: pnpm run lint
      
      - name: Type check
        run: pnpm run type-check

  # Job 2: Unit Tests
  test-unit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      
      - uses: actions/setup-node@v3
        with:
          node-version: 20
          cache: 'pnpm'
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Run unit tests
        run: pnpm run test:unit
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          files: ./coverage/lcov.info

  # Job 3: Integration Tests
  test-integration:
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:16-alpine
        env:
          POSTGRES_PASSWORD: postgres
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
      redis:
        image: redis:7-alpine
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    
    steps:
      - uses: actions/checkout@v3
      
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      
      - uses: actions/setup-node@v3
        with:
          node-version: 20
          cache: 'pnpm'
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Run migrations
        run: pnpm run db:migrate
        env:
          DATABASE_URL: postgresql://postgres:postgres@localhost:5432/test
      
      - name: Run integration tests
        run: pnpm run test:integration
        env:
          DATABASE_URL: postgresql://postgres:postgres@localhost:5432/test
          REDIS_URL: redis://localhost:6379

  # Job 4: E2E Tests
  test-e2e:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      
      - uses: actions/setup-node@v3
        with:
          node-version: 20
          cache: 'pnpm'
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Install Playwright
        run: pnpm exec playwright install --with-deps
      
      - name: Run E2E tests
        run: pnpm run test:e2e
      
      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v3
        with:
          name: playwright-report
          path: playwright-report/

  # Job 5: Build
  build:
    needs: [lint, test-unit, test-integration, test-e2e]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      
      - uses: actions/setup-node@v3
        with:
          node-version: 20
          cache: 'pnpm'
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Build
        run: pnpm run build
      
      - name: Upload build artifacts
        uses: actions/upload-artifact@v3
        with:
          name: build
          path: |
            apps/*/dist
            apps/*/.next

  # Job 6: Deploy (only on main branch)
  deploy:
    needs: build
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Download build artifacts
        uses: actions/download-artifact@v3
        with:
          name: build
      
      - name: Deploy to production
        run: |
          echo "Deploying to production..."
          # Add deployment script here
```

---

### Pipeline Stages

**1. Code Quality (Lint + Type Check)**

```
â”œâ”€ ESLint (code style)
â”œâ”€ Prettier (formatting)
â”œâ”€ TypeScript (type safety)
â””â”€ No console.log in production
```

**2. Testing (Unit + Integration + E2E)**

```
â”œâ”€ Unit tests (fast, isolated)
â”œâ”€ Integration tests (API, DB)
â”œâ”€ E2E tests (user flows)
â””â”€ Coverage report (CodeCov)
```

**3. Build (Compilation)**

```
â”œâ”€ Build backend (TypeScript â†’ JavaScript)
â”œâ”€ Build frontend (Next.js)
â”œâ”€ Verify no build errors
â””â”€ Upload artifacts
```

**4. Deploy (Conditional)**

```
â”œâ”€ Deploy to staging (all branches)
â”œâ”€ Smoke tests in staging
â”œâ”€ Deploy to production (main only)
â””â”€ Monitor deployment
```

---

### Deployment Strategy

**Environments:**

1. **Development** (Local)
    
    - Docker Compose
    - Hot reload enabled
    - Debug logging
2. **Staging** (Pre-production)
    
    - Deployed on every PR
    - Production-like environment
    - E2E tests run here
3. **Production** (Live)
    
    - Deployed on merge to main
    - Blue-green deployment (zero downtime)
    - Rollback capability

**Deployment Script:**

```bash
#!/bin/bash

# deploy.sh

ENV=$1  # staging or production

echo "Deploying to $ENV..."

# 1. Build Docker image
docker build -t kaven-api:$ENV .

# 2. Tag image
docker tag kaven-api:$ENV ghcr.io/kaven/api:$ENV

# 3. Push to registry
docker push ghcr.io/kaven/api:$ENV

# 4. Deploy (Kubernetes or Docker Swarm)
kubectl set image deployment/kaven-api kaven-api=ghcr.io/kaven/api:$ENV

# 5. Wait for rollout
kubectl rollout status deployment/kaven-api

# 6. Smoke test
curl https://$ENV.kaven.io/health

echo "Deployment complete!"
```

---

## ğŸ“š DOCUMENTATION REQUIREMENTS

### Code Documentation

**1. Inline Comments**

```typescript
// âœ… GOOD: Explain WHY, not WHAT
// Use bcrypt cost factor 12 for balance between security and performance
// Cost 10 = ~65ms, Cost 12 = ~250ms, Cost 14 = ~1000ms
const hash = await bcrypt.hash(password, 12);

// âŒ BAD: Stating the obvious
// Hash the password
const hash = await bcrypt.hash(password, 12);
```

**2. JSDoc (Public APIs)**

```typescript
/**
 * Creates a new user with email verification flow
 * 
 * @param data - User registration data
 * @param data.email - User's email (must be unique)
 * @param data.password - User's password (min 8 chars, validated)
 * @param data.name - User's display name
 * 
 * @returns Created user object (without password)
 * 
 * @throws {ValidationError} If input data is invalid
 * @throws {ConflictError} If email already exists
 * 
 * @example
 * const user = await authService.register({
 *   email: 'john@example.com',
 *   password: 'SecurePass123!',
 *   name: 'John Doe'
 * });
 */
async register(data: RegisterInput): Promise<User> {
  // Implementation
}
```

**3. README Files**

Every package/app should have README:

```markdown
# @kaven/auth

Authentication module for Kaven Boilerplate.

## Features
- Email/Password authentication
- JWT + Refresh tokens
- 2FA TOTP
- Email verification
- Password reset

## Installation
\`\`\`bash
pnpm add @kaven/auth
\`\`\`

## Usage
\`\`\`typescript
import { AuthService } from '@kaven/auth';

const authService = new AuthService();
const user = await authService.register({...});
\`\`\`

## API Reference
See [API.md](./API.md) for complete API documentation.

## Testing
\`\`\`bash
pnpm test
\`\`\`

## License
MIT
```

---

### API Documentation

**Auto-generated with Swagger/OpenAPI:**

```typescript
// Fastify Swagger setup
import fastifySwagger from '@fastify/swagger';
import fastifySwaggerUI from '@fastify/swagger-ui';

app.register(fastifySwagger, {
  openapi: {
    info: {
      title: 'Kaven API',
      description: 'Kaven Boilerplate API Documentation',
      version: '1.0.0'
    },
    servers: [
      { url: 'http://localhost:8000', description: 'Development' },
      { url: 'https://api.kaven.io', description: 'Production' }
    ],
    tags: [
      { name: 'auth', description: 'Authentication endpoints' },
      { name: 'users', description: 'User management endpoints' },
      { name: 'tenants', description: 'Tenant management endpoints' }
    ]
  }
});

app.register(fastifySwaggerUI, {
  routePrefix: '/docs',
  uiConfig: {
    docExpansion: 'list',
    deepLinking: false
  }
});

// Endpoint with schema
app.post('/api/auth/register', {
  schema: {
    description: 'Register new user',
    tags: ['auth'],
    body: {
      type: 'object',
      required: ['email', 'password', 'name'],
      properties: {
        email: { type: 'string', format: 'email' },
        password: { type: 'string', minLength: 8 },
        name: { type: 'string', minLength: 2 }
      }
    },
    response: {
      201: {
        description: 'User created successfully',
        type: 'object',
        properties: {
          id: { type: 'string' },
          email: { type: 'string' },
          name: { type: 'string' },
          emailVerified: { type: 'boolean' }
        }
      },
      409: {
        description: 'Email already exists',
        type: 'object',
        properties: {
          error: { type: 'string' }
        }
      }
    }
  }
}, async (request, reply) => {
  // Handler
});
```

**Access Documentation:**

```
http://localhost:8000/docs
```

---

## âœ… QUALITY GATES

### Pre-Commit Checks (Husky)

**Setup:**

```bash
# Install Husky
pnpm add -D husky

# Initialize Husky
pnpm exec husky install

# Add pre-commit hook
pnpm exec husky add .husky/pre-commit "pnpm run pre-commit"
```

**Pre-commit Script:**

```json
// package.json
{
  "scripts": {
    "pre-commit": "lint-staged"
  }
}
```

**Lint-staged Config:**

```json
// package.json
{
  "lint-staged": {
    "*.{ts,tsx}": [
      "eslint --fix",
      "prettier --write",
      "vitest related --run"
    ],
    "*.{json,md,yml}": [
      "prettier --write"
    ]
  }
}
```

**What Runs:**

- âœ… ESLint (auto-fix)
- âœ… Prettier (auto-format)
- âœ… Tests related to changed files
- âœ… Type check

**If Fails:**

- âŒ Commit blocked
- âŒ Fix issues manually
- âŒ Try commit again

---

### Pre-Push Checks

**Setup:**

```bash
# Add pre-push hook
pnpm exec husky add .husky/pre-push "pnpm run pre-push"
```

**Pre-push Script:**

```json
// package.json
{
  "scripts": {
    "pre-push": "pnpm run type-check && pnpm run test:unit"
  }
}
```

**What Runs:**

- âœ… Type check (TypeScript)
- âœ… Unit tests (all)

**If Fails:**

- âŒ Push blocked
- âŒ Fix issues manually
- âŒ Try push again

---

### PR Quality Gates

**Automated Checks (Must Pass):**

- âœ… Linting (ESLint)
- âœ… Type check (TypeScript)
- âœ… Unit tests (80%+ coverage)
- âœ… Integration tests
- âœ… Build succeeds
- âœ… No merge conflicts
- âœ… Branch up-to-date with main

**Manual Checks (Reviewer):**

- âœ… Code review approval
- âœ… Acceptance criteria met
- âœ… Documentation updated
- âœ… No breaking changes (or documented)

**If Fails:**

- âŒ Cannot merge
- âŒ Fix issues
- âŒ Request re-review

---

## ğŸš¢ RELEASE PROCESS

### Semantic Versioning

**Format:** `MAJOR.MINOR.PATCH`

**Version Bumps:**

- `MAJOR` - Breaking changes (1.0.0 â†’ 2.0.0)
- `MINOR` - New features (1.0.0 â†’ 1.1.0)
- `PATCH` - Bug fixes (1.0.0 â†’ 1.0.1)

**Pre-release:** `1.0.0-alpha.1`, `1.0.0-beta.1`, `1.0.0-rc.1`

**Examples:**

```
1.0.0 â†’ 1.0.1  (Bug fix)
1.0.1 â†’ 1.1.0  (New feature)
1.1.0 â†’ 2.0.0  (Breaking change)
```

---

### Release Workflow

**1. Prepare Release**

```bash
# Create release branch
git checkout -b release/v1.0.0

# Update version in package.json
npm version 1.0.0

# Update CHANGELOG.md
# Add release notes

# Commit changes
git add .
git commit -m "chore: prepare release v1.0.0"

# Push release branch
git push origin release/v1.0.0
```

**2. Create PR**

```
Title: "Release v1.0.0"
Description:
- List of features
- List of bug fixes
- Breaking changes (if any)
- Migration guide (if breaking)
```

**3. Review & Test**

```
- Code review
- QA testing in staging
- Performance testing
- Security audit
```

**4. Merge & Tag**

```bash
# Merge to main
git checkout main
git merge release/v1.0.0

# Create tag
git tag -a v1.0.0 -m "Release v1.0.0"

# Push tag
git push origin v1.0.0
```

**5. Deploy**

```
- CI/CD auto-deploys from tag
- Monitor deployment
- Verify in production
```

**6. Publish**

```bash
# Publish to npm (if public)
npm publish

# Create GitHub Release
# Add changelog
# Upload artifacts (if any)
```

**7. Announce**

```
- Tweet release
- Blog post (if major)
- Update documentation
- Notify users (email/Discord/Slack)
```

---

### Changelog Format

**File:** `CHANGELOG.md`

```markdown
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

## [1.0.0] - 2026-05-12

### Added
- Multi-tenant architecture with "CamaleÃ£o" middleware
- 2FA TOTP authentication
- Stripe payment integration
- Pix payment support (Brazilian market)
- Admin panel with 30+ pages
- Prometheus + Grafana observability
- Complete API documentation (Swagger)

### Changed
- Migrated from Express to Fastify (2x performance improvement)
- Updated database schema to support multi-tenancy

### Fixed
- Fixed login rate limiting bypass vulnerability
- Resolved Stripe webhook signature validation issue

### Security
- Added OWASP Top 10 mitigations
- Implemented row-level security (RLS)
- Added comprehensive audit logging

## [0.1.0] - 2026-02-10

### Added
- Initial MVP release
- Basic authentication (email/password)
- User management
- Simple admin panel

[Unreleased]: https://github.com/kaven/boilerplate/compare/v1.0.0...HEAD
[1.0.0]: https://github.com/kaven/boilerplate/compare/v0.1.0...v1.0.0
[0.1.0]: https://github.com/kaven/boilerplate/releases/tag/v0.1.0
```

---

## ğŸ“ SUMMARY

### SDLC Principles Recap

1. **Documentation First** - Write specs before code
2. **Test-Driven Development** - Write tests before implementation
3. **Continuous Integration** - Merge often, test automatically
4. **Code Review** - Every PR reviewed
5. **Iterative Delivery** - Small, frequent releases
6. **Quality Gates** - Automated checks at every stage
7. **Semantic Versioning** - Clear version communication
8. **Comprehensive Testing** - Unit, integration, E2E
9. **Automated Deployment** - CI/CD pipeline
10. **Continuous Monitoring** - Observability built-in

---

### Quick Reference

**Branch Naming:**

```
feature/auth-2fa
fix/login-rate-limit
hotfix/security-patch
```

**Commit Convention:**

```
feat(auth): add 2FA TOTP authentication
fix(payments): resolve Stripe webhook validation
docs(api): update authentication endpoints
```

**Test Commands:**

```bash
pnpm test:unit          # Unit tests
pnpm test:integration   # Integration tests
pnpm test:e2e          # E2E tests
pnpm test:coverage     # Coverage report
```

**Quality Checks:**

```bash
pnpm run lint          # ESLint
pnpm run type-check    # TypeScript
pnpm run format        # Prettier
pnpm run pre-commit    # All checks
```

**Deployment:**

```bash
git push origin main   # Triggers CI/CD
git tag v1.0.0         # Create release
git push origin v1.0.0 # Deploy tagged version
```

---

## ğŸ“ CHANGELOG

### v1.0.0 (December 16, 2025)

- Initial SDLC process documentation
- Development methodology defined (Iterative + V-Model + DevSecOps)
- Git workflow documented (GitHub Flow)
- Testing strategy established (Unit + Integration + E2E)
- CI/CD pipeline configured (GitHub Actions)
- Quality gates implemented (Pre-commit, Pre-push, PR)
- Release process defined (Semantic Versioning)
- Documentation requirements specified

---

**End of Foundation Phase Documentation**

All 6 core artifacts completed:

1. âœ… PROJECT_OVERVIEW.md
2. âœ… SCOPE_COMPLETE.md
3. âœ… ARCHITECTURE.md
4. âœ… ROADMAP.md
5. âœ… TECH_STACK.md
6. âœ… SDLC_PROCESS.md

**Next Phase:** Development (Week 3+)