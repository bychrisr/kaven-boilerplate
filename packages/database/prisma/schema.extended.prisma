// ============================================
// SCHEMA EXTENDED - CUSTOMIZAÇÕES DO DESENVOLVEDOR
// ============================================
//
// ⚠️ IMPORTANTE: ESTRUTURA DO SCHEMA
//
// Este projeto usa uma estrutura modular de schemas Prisma:
//
// 1. schema.base.prisma
//    - Core imutável da plataforma (Tenant, User, Subscription, etc)
//    - NÃO EDITE este arquivo diretamente
//    - Mantido pela equipe core do Kaven
//
// 2. schema.extended.prisma (ESTE ARQUIVO)
//    - Onde o desenvolvedor adiciona SUAS tabelas e customizações
//    - Adicione seus modelos, enums e relations aqui
//    - Este arquivo é mesclado com schema.base.prisma
//
// 3. schema.prisma (GERADO AUTOMATICAMENTE)
//    - Resultado da mesclagem de base + extended
//    - NÃO EDITE manualmente
//
// REGRA DE OURO:
// - Modelos CORE (Tenant, User, etc) → schema.base.prisma
// - Modelos CUSTOM (suas features) → schema.extended.prisma (AQUI)
//
// ============================================

// ===========================
// DEMO FEATURES (Projects/Tasks)
// ===========================
// Estes modelos são EXEMPLOS de features customizadas
// Você pode removê-los ou adaptá-los conforme necessário

enum ProjectStatus {
  ACTIVE
  ARCHIVED
  COMPLETED
}

model Project {
  id          String   @id @default(uuid())
  name        String
  description String?
  status      ProjectStatus @default(ACTIVE)
  color       String?  @default("#3B82F6")

  tenantId    String   @map("tenant_id")
  tenant      Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  // Space Isolation
  spaceId     String?  @map("space_id")
  space       Space?   @relation(fields: [spaceId], references: [id], onDelete: Cascade)

  createdById String   @map("created_by_id")
  createdBy   User     @relation("ProjectCreator", fields: [createdById], references: [id])

  tasks       Task[]

  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([tenantId])
  @@index([spaceId])
  @@index([createdById])
  @@map("projects")
}

enum TaskStatus {
  TODO
  IN_PROGRESS
  IN_REVIEW
  DONE
}

enum TaskPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

model Task {
  id          String   @id @default(uuid())
  title       String
  description String?
  status      TaskStatus @default(TODO)
  priority    TaskPriority @default(MEDIUM)
  dueDate     DateTime? @map("due_date")

  projectId   String   @map("project_id")
  project     Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)

  assigneeId  String?  @map("assignee_id")
  assignee    User?    @relation("TaskAssignee", fields: [assigneeId], references: [id])

  tenantId    String   @map("tenant_id")
  tenant      Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  createdById String   @map("created_by_id")
  createdBy   User     @relation("TaskCreator", fields: [createdById], references: [id])

  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([tenantId])
  @@index([projectId])
  @@index([assigneeId])
  @@map("tasks")
}
